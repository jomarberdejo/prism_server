{"version":3,"sources":["../src/index.ts","../src/controllers/users/routes.ts","../src/constants/roles.ts","../src/constants/status.ts","../src/config/env.ts","../src/constants/env.ts","../src/lib/prisma.ts","../src/data/user.ts","../src/utils/error.ts","../src/services/user.ts","../src/services/auth.ts","../src/data/session.ts","../src/controllers/users/index.ts","../src/middlewares/auth.ts","../src/constants/cookies.ts","../src/controllers/auth/routes.ts","../src/controllers/auth/index.ts","../src/controllers/ppa/routes.ts","../src/controllers/ppa/index.ts","../src/data/ppa.ts","../src/services/notificationService.ts","../src/utils/dates.ts","../src/services/venue.ts","../src/services/ppa.ts","../src/controllers/sector/routes.ts","../src/controllers/sector/index.ts","../src/data/implementingUnit.ts","../src/data/sector.ts","../src/services/sector.ts","../src/controllers/implementingUnit/routes.ts","../src/controllers/implementingUnit/index.ts","../src/services/implementingUnit.ts","../src/controllers/routes.ts","../src/middlewares/error-handler.ts"],"sourcesContent":["import 'dotenv/config';\r\nimport { serve } from \"@hono/node-server\";\r\nimport { Hono } from \"hono\";\r\nimport { routes } from \"./controllers/routes\";\r\nimport { errorHandlerMiddleware } from \"./middlewares/error-handler\";\r\nimport { logger } from \"hono/logger\";\r\nimport { envConfig } from \"./config/env\";\r\nimport { startCronScheduler } from \"./services/notificationService\";\r\nimport { cors } from 'hono/cors';\r\n\r\nconst app = new Hono();\r\n\r\napp.onError(errorHandlerMiddleware);\r\napp.use(logger());\r\napp.use(cors());\r\n\r\nroutes.forEach((route) => {\r\n  app.route(\"/api\", route);\r\n});\r\n\r\nserve(\r\n  {\r\n    fetch: app.fetch,\r\n    port: envConfig.APP_PORT,\r\n    hostname: \"0.0.0.0\",\r\n  },\r\n  (info) => {\r\n    console.log(`âœ… Server is running on http://localhost:${info.port}`);\r\n    startCronScheduler();\r\n  },\r\n);\r\n","import { Hono } from \"hono\";\r\nimport { userHandler } from \"@/controllers/users\";\r\nimport { authMiddleware } from \"@/middlewares/auth\";\r\nconst router = new Hono();\r\n\r\nrouter.get(\"/users\", userHandler.getAll);\r\nrouter.get(\"/users/heads\", userHandler.getAllHeads);\r\nrouter.patch(\"/users/change-password\", authMiddleware, userHandler.updatePassword);\r\nrouter.patch(\"/users/:id\", userHandler.updateProfile);\r\nrouter.patch(\"/users/:id/role\", userHandler.updateRole);\r\nrouter.patch(\"/users/:id/status\", userHandler.updateStatus);\r\nrouter.patch(\"/users/:id/department-head\", userHandler.updateDepartmentHeadStatus);\r\nrouter.delete(\"/users/:id\", userHandler.delete);\r\n\r\nexport default router;\r\n","export const VALID_ROLES = [\r\n  \"SUPER_ADMIN\",\r\n  \"ADMIN\",\r\n  \"EDITOR\",\r\n  \"VIEWER\",\r\n] as const;\r\n","export const VALID_STATUSES = [\r\n  \"PENDING\",\r\n  \"ACTIVE\",\r\n  \"REJECTED\",\r\n] as const;\r\n","import {z} from 'zod';\r\nimport { NODE_ENV } from '@/constants/env';\r\n\r\nconst envSchema = z.object({\r\n    DATABASE_URL: z.string(),\r\n    NODE_ENV: z.nativeEnum(NODE_ENV).default(NODE_ENV.Local),\r\n    APP_PORT: z.coerce.number().default(3000),\r\n    JWT_SECRET: z.string(),\r\n    SERVICE_ACCOUNT_JSON: z.string(),\r\n})\r\n\r\nexport const envConfig = envSchema.parse({\r\n    DATABASE_URL: process.env.DATABASE_URL,\r\n    NODE_ENV: process.env.NODE_ENV,\r\n    APP_PORT: process.env.APP_PORT,\r\n    JWT_SECRET: process.env.JWT_SECRET,\r\n    SERVICE_ACCOUNT_JSON: process.env.SERVICE_ACCOUNT_JSON,\r\n})\r\n\r\nexport type EnvConfig = z.infer<typeof envSchema>;\r\n\r\n\r\n","export const NODE_ENV = {\r\n  Local: \"local\",\r\n  Dev: \"development\",\r\n  Prod: \"production\",\r\n} as const;\r\n\r\nexport type ENV_KEY = keyof typeof NODE_ENV;\r\nexport type NODE_ENV_TYPE = (typeof NODE_ENV)[ENV_KEY];\r\n","import { envConfig } from \"@/config/env\";\r\nimport { PrismaClient } from \"@prisma/client\";\r\n\r\ndeclare global {\r\n  var prisma: PrismaClient | undefined;\r\n}\r\n\r\nconst prisma = global.prisma || new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== envConfig.NODE_ENV) {\r\n  global.prisma = prisma;\r\n}\r\n\r\nexport default prisma;\r\n","import prisma from \"@/lib/prisma\";\r\nimport { USER_STATUS, type Prisma, type ROLE, type User } from \"@prisma/client\";\r\n\r\nconst userSelect: Prisma.UserSelect = {\r\n  id: true,\r\n  email: true,\r\n  username: true,\r\n  name: true,\r\n  role: true,\r\n  createdAt: true,\r\n  isDepartmentHead: true,\r\n  pushToken: true,\r\n  status: true,\r\n  // password: true,\r\n} as const;\r\n\r\nexport const userRepository = {\r\n  async findByEmail(email: string) {\r\n    return prisma.user.findUnique({\r\n      where: { email },\r\n    });\r\n  },\r\n\r\n  async findByUsername(username: string) {\r\n    return prisma.user.findUnique({\r\n      where: { username },\r\n    });\r\n  },\r\n\r\n  async findById(id: string) {\r\n    return prisma.user.findUnique({\r\n      where: { id },\r\n      select: userSelect,\r\n    });\r\n  },\r\n\r\n  async findActiveUsersWithPushTokens() {\r\n    return prisma.user.findMany({\r\n      where: {\r\n        status: USER_STATUS.ACTIVE,\r\n        pushToken: {\r\n          not: null,\r\n        },\r\n      },\r\n      select: {\r\n        id: true,\r\n        name: true,\r\n        email: true,\r\n        username: true,\r\n        pushToken: true,\r\n        role: true,\r\n      },\r\n    });\r\n  },\r\n\r\n  async create(\r\n    hashedPassword: string,\r\n    name: string,\r\n    isDepartmentHead: boolean,\r\n    role: ROLE,\r\n    username: string,\r\n    email?: string,\r\n  ) {\r\n    return prisma.user.create({\r\n      data: {\r\n        email,\r\n        password: hashedPassword,\r\n        name,\r\n        isDepartmentHead,\r\n        role,\r\n        username,\r\n      },\r\n      select: userSelect,\r\n    });\r\n  },\r\n\r\n  async findAll() {\r\n    return prisma.user.findMany({\r\n      orderBy: { createdAt: \"desc\" },\r\n      select: {\r\n        ...userSelect,\r\n        departmentHead: true,\r\n        sessions: {\r\n          select: {\r\n            id: true,\r\n            createdAt: true,\r\n            token: true,\r\n          },\r\n        },\r\n      },\r\n    });\r\n  },\r\n\r\n  async findByRole(role: ROLE) {\r\n    return prisma.user.findMany({\r\n      where: { role },\r\n      select: userSelect,\r\n    });\r\n  },\r\n\r\n  async updateProfile(id: string, profileData: User) {\r\n    return prisma.user.update({\r\n      where: { id },\r\n      data: profileData,\r\n      select: userSelect,\r\n    });\r\n  },\r\n\r\n  async updateRole(id: string, role: ROLE) {\r\n    return prisma.user.update({\r\n      where: { id },\r\n      data: { role },\r\n      select: userSelect,\r\n    });\r\n  },\r\n\r\n  async updateStatus(id: string, status: USER_STATUS) {\r\n    return prisma.user.update({\r\n      where: { id },\r\n      data: { status },\r\n      select: userSelect,\r\n    });\r\n  },\r\n\r\n  async updatePassword(userId: string, hashedPassword: string) {\r\n    return await prisma.user.update({\r\n      where: { id: userId },\r\n      data: { password: hashedPassword },\r\n      select: {\r\n        id: true,\r\n        name: true,\r\n        username: true,\r\n        email: true,\r\n        role: true,\r\n        status: true,\r\n      },\r\n    });\r\n  },\r\n\r\n  async updatePushToken(username: string, pushToken: string) {\r\n    return prisma.user.update({\r\n      where: { username },\r\n      data: { pushToken },\r\n      select: userSelect,\r\n    });\r\n  },\r\n\r\n  async delete(id: string) {\r\n    return prisma.user.delete({\r\n      where: { id },\r\n    });\r\n  },\r\n\r\n  async updateDepartmentHeadStatus(userId: string, isDepartmentHead: boolean) {\r\n    return prisma.user.update({\r\n      where: { id: userId },\r\n      data: { isDepartmentHead },\r\n    });\r\n  },\r\n\r\n  async getDepartmentHeads() {\r\n    return prisma.user.findMany({\r\n      where: { isDepartmentHead: true },\r\n      select: {\r\n        id: true,\r\n        name: true,\r\n        email: true,\r\n        role: true,\r\n        departmentHead: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n          },\r\n        },\r\n      },\r\n    });\r\n  },\r\n};\r\n","import { StatusCodes } from \"http-status-codes\";\n\nexport class BadRequestError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"BadRequestError\";\n    this.message = message;\n  }\n}\n\nexport class UnauthorizedError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"UnauthorizedError\";\n    this.message = message;\n  }\n}\n\nexport class ForbiddenError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"ForbiddenError\";\n    this.message = message;\n  }\n}\n\nexport class NotFoundError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"NotFoundError\";\n    this.message = message;\n  }\n}\n\nexport class ConflictError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"ConflictError\";\n    this.message = message;\n  }\n}\n\nexport function makeError<TError extends Error>(error: TError) {\n  const defaultError = {\n    name: error.name,\n    message: error.message,\n  };\n\n  if (error.message.includes(\"Malformed JSON\")) {\n    return {\n      statusCode: StatusCodes.BAD_REQUEST,\n      error: { name: \"BadRequestError\", message: error.message },\n    };\n  }\n\n  if (error instanceof BadRequestError) {\n    return {\n      statusCode: StatusCodes.BAD_REQUEST,\n      error: defaultError,\n    };\n  }\n\n  if (error instanceof UnauthorizedError) {\n    return {\n      statusCode: StatusCodes.UNAUTHORIZED,\n      error: defaultError,\n    };\n  }\n\n  if (error instanceof ForbiddenError) {\n    return {\n      statusCode: StatusCodes.FORBIDDEN,\n      error: defaultError,\n    };\n  }\n\n  if (error instanceof NotFoundError) {\n    return {\n      statusCode: StatusCodes.NOT_FOUND,\n      error: defaultError,\n    };\n  }\n\n  if (error instanceof ConflictError) {\n    return {\n      statusCode: StatusCodes.CONFLICT,\n      error: defaultError,\n    };\n  }\n\n  return {\n    statusCode: StatusCodes.INTERNAL_SERVER_ERROR,\n    error: defaultError,\n  };\n}\n","import { VALID_ROLES } from \"@/constants/roles\";\r\nimport { VALID_STATUSES } from \"@/constants/status\";\r\nimport { userRepository } from \"@/data/user\";\r\nimport {\r\n  NotFoundError,\r\n  BadRequestError,\r\n  UnauthorizedError,\r\n} from \"@/utils/error\";\r\nimport { type USER_STATUS, type ROLE } from \"@prisma/client\";\r\nimport { authService } from \"./auth\";\r\n\r\nexport const userService = {\r\n  async getUserById(id: string) {\r\n    const user = await userRepository.findById(id);\r\n    if (!user) {\r\n      throw new NotFoundError(\"User not found\");\r\n    }\r\n    return user;\r\n  },\r\n\r\n  async getAllUsers() {\r\n    return userRepository.findAll();\r\n  },\r\n\r\n  async getUsersByRole(role: ROLE) {\r\n    if (!VALID_ROLES.includes(role as any)) {\r\n      throw new BadRequestError(\"Invalid role\");\r\n    }\r\n    return userRepository.findByRole(role);\r\n  },\r\n\r\n  async updateProfile(userId: string, profileData: any) {\r\n    return userRepository.updateProfile(userId, profileData);\r\n  },\r\n\r\n  async updatePassword(\r\n    userId: string,\r\n    currentPassword: string,\r\n    newPassword: string\r\n  ) {\r\n    const user = await userRepository.findById(userId);\r\n    if (!user) {\r\n      throw new NotFoundError(\"User not found\");\r\n    }\r\n\r\n    const isValidPassword = await authService.comparePassword(\r\n      currentPassword,\r\n      user.password\r\n    );\r\n    if (!isValidPassword) {\r\n      throw new BadRequestError(\"Current password is incorrect\");\r\n    }\r\n\r\n    if (newPassword.length < 6) {\r\n      throw new BadRequestError(\"New password must be at least 6 characters\");\r\n    }\r\n\r\n    const isSamePassword = await authService.comparePassword(\r\n      newPassword,\r\n      user.password\r\n    );\r\n    if (isSamePassword) {\r\n      throw new BadRequestError(\r\n        \"New password must be different from current password\"\r\n      );\r\n    }\r\n\r\n    const hashedPassword = await authService.hashPassword(newPassword);\r\n    await userRepository.updatePassword(userId, hashedPassword);\r\n  },\r\n\r\n  async updateUserRole(userId: string, role: ROLE) {\r\n    if (!VALID_ROLES.includes(role)) {\r\n      throw new BadRequestError(\"Invalid role\");\r\n    }\r\n\r\n    const user = await this.getUserById(userId);\r\n    return userRepository.updateRole(userId, role);\r\n  },\r\n\r\n  async updateUserStatus(userId: string, status: USER_STATUS) {\r\n    if (!VALID_STATUSES.includes(status)) {\r\n      throw new BadRequestError(\"Invalid status\");\r\n    }\r\n\r\n    const user = await this.getUserById(userId);\r\n    return userRepository.updateStatus(userId, status);\r\n  },\r\n\r\n  async updateDepartmentHeadStatus(userId: string, isDepartmentHead: boolean) {\r\n    const user = await this.getUserById(userId);\r\n    return userRepository.updateDepartmentHeadStatus(userId, isDepartmentHead);\r\n  },\r\n\r\n  async deleteUser(id: string) {\r\n    await this.getUserById(id);\r\n    return userRepository.delete(id);\r\n  },\r\n\r\n  async getAllDepartmentHeads() {\r\n    const users = await userRepository.getDepartmentHeads();\r\n    const mappedUsers = users.map((user) => ({\r\n      label: user.name,\r\n      value: user.id,\r\n    }));\r\n\r\n    return mappedUsers;\r\n  },\r\n};\r\n","import {\r\n  ConflictError,\r\n  UnauthorizedError,\r\n  BadRequestError,\r\n} from \"@/utils/error\";\r\nimport type { TokenPayload } from \"@/types/auth\";\r\nimport { sign, verify } from \"hono/jwt\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport { userRepository } from \"@/data/user\";\r\nimport { sessionRepository } from \"@/data/session\";\r\nimport { envConfig } from \"@/config/env\";\r\nimport { USER_STATUS, type ROLE } from \"@prisma/client\";\r\n\r\nexport const authService = {\r\n  generateToken(payload: TokenPayload): Promise<string> {\r\n    return sign(payload, envConfig.JWT_SECRET!, \"HS256\");\r\n  },\r\n\r\n  async verifyToken(token: string): Promise<TokenPayload | null> {\r\n    try {\r\n      const payload = await verify(token, envConfig.JWT_SECRET!, \"HS256\");\r\n      return {\r\n        userId: payload.userId as string,\r\n        username: payload.username as string,\r\n        role: payload.role as string,\r\n      };\r\n    } catch {\r\n      return null;\r\n    }\r\n  },\r\n\r\n  async hashPassword(password: string): Promise<string> {\r\n    return bcrypt.hash(password, 10);\r\n  },\r\n\r\n  async comparePassword(password: string, hash: string): Promise<boolean> {\r\n    return bcrypt.compare(password, hash);\r\n  },\r\n\r\n  async register(\r\n    password: string,\r\n    name: string,\r\n    username: string,\r\n    isDepartmentHead: boolean,\r\n    role: ROLE,\r\n    email?: string\r\n  ) {\r\n    if (email) {\r\n      const existingUser = await userRepository.findByEmail(email);\r\n      if (existingUser) {\r\n        throw new ConflictError(\"Email already in use\");\r\n      }\r\n    }\r\n\r\n    const existingUser = await userRepository.findByUsername(username);\r\n    if (existingUser) {\r\n      throw new ConflictError(\"Username already in use\");\r\n    }\r\n\r\n    if (password.length < 6) {\r\n      throw new BadRequestError(\"Password must be at least 6 characters\");\r\n    }\r\n\r\n    const hashedPassword = await this.hashPassword(password);\r\n    return userRepository.create(\r\n      hashedPassword,\r\n      name,\r\n      isDepartmentHead,\r\n      role,\r\n      username,\r\n      email\r\n    );\r\n  },\r\n\r\n  async login(username: string, password: string, pushToken?: string) {\r\n    const user = await userRepository.findByUsername(username);\r\n    if (!user) {\r\n      throw new UnauthorizedError(\"Invalid credentials\");\r\n    }\r\n\r\n    if (user.status === USER_STATUS.PENDING) {\r\n      throw new UnauthorizedError(\"Account is pending approval\");\r\n    }\r\n    if (user.status === USER_STATUS.REJECTED) {\r\n      throw new UnauthorizedError(\"Account is rejected\");\r\n    }\r\n\r\n    const isPasswordValid = await this.comparePassword(password, user.password);\r\n    if (!isPasswordValid) {\r\n      throw new UnauthorizedError(\"Invalid credentials\");\r\n    }\r\n\r\n    if (pushToken) {\r\n      await userRepository.updatePushToken(username, pushToken);\r\n    }\r\n\r\n    return user;\r\n  },\r\n\r\n  async createSession(\r\n    userId: string,\r\n    username: string,\r\n    role: string\r\n  ): Promise<string> {\r\n    await sessionRepository.deleteByUserId(userId);\r\n\r\n    const token = await this.generateToken({ userId, username, role });\r\n\r\n    const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);\r\n\r\n    await sessionRepository.create(userId, token, expiresAt);\r\n    return token;\r\n  },\r\n\r\n  async destroySession(token: string) {\r\n    return sessionRepository.deleteByToken(token);\r\n  },\r\n};\r\n","import prisma from \"@/lib/prisma\";\n\nexport const sessionRepository = {\n  async create(userId: string, token: string, expiresAt: Date) {\n    return prisma.session.create({\n      data: { userId, token, expiresAt },\n    });\n  },\n\n  async findByToken(token: string) {\n    return prisma.session.findUnique({\n      where: { token },\n      include: { user: true },\n    });\n  },\n\n  async deleteByToken(token: string) {\n    try {\n      return await prisma.session.delete({ where: { token } });\n    } catch {\n      return null;\n    }\n  },\n\n  async deleteByUserId(userId: string) {\n    return prisma.session.deleteMany({\n      where: { userId },\n    });\n  },\n};\n","import { userService } from \"@/services/user\";\r\nimport type { ROLE } from \"@prisma/client\";\r\nimport type { Context } from \"hono\";\r\nimport { StatusCodes } from \"http-status-codes\";\r\n\r\nexport const userHandler = {\r\n  async getAll(c: Context) {\r\n    const users = await userService.getAllUsers();\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { users },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getAllHeads(c: Context) {\r\n    const users = await userService.getAllDepartmentHeads();\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: users,\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getById(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const user = await userService.getUserById(id);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { user },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getByRole(c: Context) {\r\n    const role = c.req.param(\"role\") as ROLE;\r\n    const users = await userService.getUsersByRole(role);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { users },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async updateProfile(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const body = await c.req.json();\r\n\r\n    const user = await userService.updateProfile(id, body);\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Profile updated successfully\",\r\n        data: { user },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async updateRole(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const { role } = await c.req.json();\r\n\r\n    const user = await userService.updateUserRole(id, role);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Role updated successfully\",\r\n        data: { user },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n  async updateStatus(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const { status } = await c.req.json();\r\n\r\n    const user = await userService.updateUserStatus(id, status);\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Status updated successfully\",\r\n        data: { user },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async updateDepartmentHeadStatus(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const { isDepartmentHead } = await c.req.json();\r\n\r\n    const user = await userService.updateDepartmentHeadStatus(\r\n      id,\r\n      isDepartmentHead\r\n    );\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Department head status updated successfully\",\r\n        data: { user },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async updatePassword(c: Context) {\r\n    const { currentPassword, newPassword } = await c.req.json();\r\n    const user = c.get(\"user\");\r\n\r\n    await userService.updatePassword(user.id, currentPassword, newPassword);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Password updated successfully\",\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async delete(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    await userService.deleteUser(id);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"User deleted successfully\",\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n};\r\n","import type { Context, Next } from \"hono\";\r\nimport { getCookie } from \"hono/cookie\";\r\n\r\nimport { UnauthorizedError, ForbiddenError } from \"@/utils/error\";\r\nimport type { UserPayload } from \"@/types/auth\";\r\nimport { sessionRepository } from \"@/data/session\";\r\nimport { authService } from \"@/services/auth\";\r\nimport { COOKIE_NAMES } from \"@/constants/cookies\";\r\n\r\ndeclare global {\r\n  namespace HonoRequest {\r\n    interface HonoContextVariables {\r\n      user: UserPayload;\r\n    }\r\n  }\r\n}\r\n\r\nexport const authMiddleware = async (c: Context, next: Next) => {\r\n  const token = getCookie(c, COOKIE_NAMES.accessToken);\r\n\r\n  if (!token) {\r\n    throw new UnauthorizedError(\"No token provided\");\r\n  }\r\n\r\n  const session = await sessionRepository.findByToken(token);\r\n\r\n  if (!session || new Date() > session.expiresAt) {\r\n    throw new UnauthorizedError(\"Session expired or invalid\");\r\n  }\r\n\r\n  const payload = await authService.verifyToken(token);\r\n  if (!payload) {\r\n    throw new UnauthorizedError(\"Invalid token\");\r\n  }\r\n\r\n  const user: UserPayload = {\r\n    id: payload.userId,\r\n    username: payload.username,\r\n    role: payload.role,\r\n  };\r\n\r\n  c.set(\"user\", user);\r\n  await next();\r\n};\r\n\r\nexport const requireRole = (allowedRoles: string[]) => {\r\n  return async (c: Context, next: Next) => {\r\n    const user = c.get(\"user\") as UserPayload | undefined;\r\n\r\n\r\n    if (!user || !allowedRoles.includes(user.role)) {\r\n      throw new ForbiddenError(\"Insufficient permissions\");\r\n    }\r\n\r\n    await next();\r\n  };\r\n};\r\n","import { envConfig } from \"@/config/env\";\r\n\r\nexport const COOKIE_NAMES = {\r\n  accessToken: \"accessToken\",\r\n} as const;\r\n\r\nexport const COOKIE_CONFIG = {\r\n  httpOnly: true,\r\n  secure: process.env.NODE_ENV === \"production\",\r\n  sameSite: \"Lax\" as const,\r\n  maxAge: 7 * 24 * 60 * 60,\r\n  path: \"/\",\r\n} as const;\r\n\r\nexport const JWT_SECRET = envConfig.JWT_SECRET;\r\n","import { Hono } from \"hono\";\nimport { authHandler } from \"@/controllers/auth\";\nconst router = new Hono();\n\nrouter.post(\"/auth/register\", authHandler.register);\nrouter.post(\"/auth/login\", authHandler.login);\nrouter.post(\"/auth/logout\", authHandler.logout);\n\nexport default router;\n","import {\r\n  deleteCookie,\r\n  getCookie,\r\n  setCookie,\r\n} from \"hono/cookie\";\r\nimport type { Context } from \"hono\";\r\nimport { StatusCodes } from \"http-status-codes\";\r\nimport { BadRequestError } from \"@/utils/error\";\r\nimport { authService } from \"@/services/auth\";\r\nimport { COOKIE_CONFIG, COOKIE_NAMES } from \"@/constants/cookies\";\r\n\r\nexport const authHandler = {\r\n  async register(c: Context) {\r\n    const { email, password, name, username, isDepartmentHead, role } = await c.req.json();\r\n\r\n    if (!password || !name || !username) {\r\n      throw new BadRequestError(\"Missing required fields\");\r\n    }\r\n\r\n    const user = await authService.register(password, name, username, isDepartmentHead, role, email);\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"User registered successfully\",\r\n        data: { user },\r\n      },\r\n      StatusCodes.CREATED\r\n    );\r\n  },\r\n\r\n  async login(c: Context) {\r\n    const { username, password, pushToken } = await c.req.json();\r\n\r\n\r\n    if (!username || !password) {\r\n      throw new BadRequestError(\"Username and password required\");\r\n    }\r\n\r\n    const user = await authService.login(username, password, pushToken);\r\n\r\n    const token = await authService.createSession(\r\n      user.id,\r\n      user.username,\r\n      user.role\r\n    );\r\n\r\n    \r\n\r\n    setCookie(c, COOKIE_NAMES.accessToken, token, COOKIE_CONFIG);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Logged in successfully\",\r\n        data: {\r\n          user: {\r\n            id: user.id,\r\n            email: user.email,\r\n            username: user.username,\r\n            name: user.name,\r\n            role: user.role,\r\n            isDepartmentHead: user.isDepartmentHead,\r\n          },\r\n          token,\r\n        },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async logout(c: Context) {\r\n    const token = getCookie(c, COOKIE_NAMES.accessToken);\r\n\r\n    if (token) {\r\n      await authService.destroySession(token);\r\n    }\r\n\r\n    deleteCookie(c, COOKIE_NAMES.accessToken, COOKIE_CONFIG);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Logged out successfully\",\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getCurrentUser(c: Context) {\r\n    const user = c.get(\"user\");\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { user },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n};","import { Hono } from \"hono\";\r\nimport { ppaHandler } from \"@/controllers/ppa\";\r\nimport { authMiddleware, requireRole } from \"@/middlewares/auth\";\r\nconst router = new Hono();\r\n\r\nrouter.post(\"/ppas\", authMiddleware, ppaHandler.create);\r\nrouter.post(\"/ppas/check-availability\", ppaHandler.checkAvailability);\r\nrouter.get(\"/ppas\", ppaHandler.getAll);\r\nrouter.get(\"/ppas/archived\", ppaHandler.getAllArchivedPPA);\r\nrouter.get(\"/ppas/:id\", authMiddleware, ppaHandler.getById);\r\nrouter.patch(\"/ppas/:id\", authMiddleware, ppaHandler.update);\r\nrouter.delete(\"/ppas/:id\", authMiddleware, ppaHandler.delete);\r\n\r\nexport default router;\r\n","import type { Context } from \"hono\";\r\nimport { StatusCodes } from \"http-status-codes\";\r\nimport { BadRequestError, ConflictError } from \"@/utils/error\";\r\nimport { ppaService } from \"@/services/ppa\";\r\nimport { venueService } from \"@/services/venue\";\r\n\r\nexport const ppaHandler = {\r\n  async getAll(c: Context) {\r\n    const ppas = await ppaService.getAllPPAs();\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { ppas },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getAllArchivedPPA(c: Context) {\r\n    const ppas = await ppaService.getAllArchived();\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { ppas },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getById(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    if (!id) throw new BadRequestError(\"Missing PPA ID\");\r\n\r\n    const ppa = await ppaService.getPPAById(id);\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { ppa },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getBySector(c: Context) {\r\n    const sectorId = c.req.param(\"sectorId\");\r\n    if (!sectorId) throw new BadRequestError(\"Missing Sector ID\");\r\n\r\n    const ppas = await ppaService.getPPAsBySector(sectorId);\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { ppas },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getByImplementingUnit(c: Context) {\r\n    const implementingUnitId = c.req.param(\"implementingUnitId\");\r\n    if (!implementingUnitId)\r\n      throw new BadRequestError(\"Missing Implementing Unit ID\");\r\n\r\n    const ppas = await ppaService.getPPAsByImplementingUnit(implementingUnitId);\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { ppas },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async checkAvailability(c: Context) {\r\n    const body = await c.req.json();\r\n\r\n    if (!body.startDate || !body.dueDate) {\r\n      throw new BadRequestError(\"Start date and due date are required\");\r\n    }\r\n\r\n    const { startDate, dueDate, excludePPAId } = body;\r\n\r\n    const result = await venueService.checkLocationAvailability(\r\n      new Date(startDate),\r\n      new Date(dueDate),\r\n      excludePPAId,\r\n      body.venue\r\n    );\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: {\r\n          available: result.available,\r\n          conflictingPPAs: result.conflictingPPAs,\r\n          message:\r\n            result.conflictingPPAs.length === 0\r\n              ? \"No PPAs scheduled in this date range\"\r\n              : `${result.conflictingPPAs.length} PPA(s) scheduled in this date range`,\r\n        },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async create(c: Context) {\r\n    const user = c.get(\"user\");\r\n    const body = await c.req.json();\r\n\r\n    const requiredFields = [\r\n      \"task\",\r\n      \"description\",\r\n      \"address\",\r\n      \"startDate\",\r\n      \"dueDate\",\r\n      \"sectorId\",\r\n      \"implementingUnitId\",\r\n    ];\r\n\r\n    for (const field of requiredFields) {\r\n      if (!body[field]) throw new BadRequestError(`Missing field: ${field}`);\r\n    }\r\n\r\n    const newPPA = await ppaService.createPPA({\r\n      task: body.task,\r\n      description: body.description,\r\n      address: body.address,\r\n      venue: body.venue,\r\n      expectedOutput: body.expectedOutput,\r\n      startDate: new Date(body.startDate),\r\n      dueDate: new Date(body.dueDate),\r\n      sectorId: body.sectorId,\r\n      budgetAllocation: body.budgetAllocation,\r\n      approvedBudget: body.approvedBudget,\r\n      implementingUnitId: body.implementingUnitId,\r\n      userId: user.id,\r\n      attendees: body.attendees,\r\n    });\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"PPA created successfully\",\r\n        data: { ppa: newPPA },\r\n      },\r\n      StatusCodes.CREATED\r\n    );\r\n  },\r\n\r\n  async update(c: Context) {\r\n    const user = c.get(\"user\");\r\n    const id = c.req.param(\"id\");\r\n    const body = await c.req.json();\r\n\r\n    if (!id) throw new BadRequestError(\"Missing PPA ID\");\r\n\r\n    const updateData: any = {\r\n      task: body.task,\r\n      description: body.description,\r\n      address: body.address,\r\n      venue: body.venue,\r\n      expectedOutput: body.expectedOutput,\r\n      sectorId: body.sectorId,\r\n      budgetAllocation: body.budgetAllocation,\r\n      approvedBudget: body.approvedBudget,\r\n      implementingUnitId: body.implementingUnitId,\r\n      status: body.status,\r\n      remarks: body.remarks,\r\n      actualOutput: body.actualOutput,\r\n      delayedReason: body.delayedReason,\r\n    };\r\n\r\n    if (body.startDate) {\r\n      if (body.startTime) {\r\n        const startDateTime = new Date(body.startDate);\r\n        const startTime = new Date(body.startTime);\r\n        startDateTime.setHours(startTime.getHours());\r\n        startDateTime.setMinutes(startTime.getMinutes());\r\n        startDateTime.setSeconds(0);\r\n        startDateTime.setMilliseconds(0);\r\n        updateData.startDate = startDateTime;\r\n      } else {\r\n        updateData.startDate = new Date(body.startDate);\r\n      }\r\n    }\r\n\r\n    if (body.dueDate) {\r\n      if (body.dueTime) {\r\n        const dueDateTime = new Date(body.dueDate);\r\n        const dueTime = new Date(body.dueTime);\r\n        dueDateTime.setHours(dueTime.getHours());\r\n        dueDateTime.setMinutes(dueTime.getMinutes());\r\n        dueDateTime.setSeconds(0);\r\n        dueDateTime.setMilliseconds(0);\r\n        updateData.dueDate = dueDateTime;\r\n      } else {\r\n        updateData.dueDate = new Date(body.dueDate);\r\n       \r\n      }\r\n    }\r\n\r\n    Object.keys(updateData).forEach((key) => {\r\n      if (updateData[key] === undefined) {\r\n        delete updateData[key];\r\n      }\r\n    });\r\n\r\n\r\n    const updated = await ppaService.updatePPA(id, updateData, user.id);\r\n\r\n   \r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"PPA updated successfully\",\r\n        data: updated,\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async delete(c: Context) {\r\n    const user = c.get(\"user\");\r\n    const id = c.req.param(\"id\");\r\n\r\n    if (!id) throw new BadRequestError(\"Missing PPA ID\");\r\n\r\n    await ppaService.deletePPA(user.id, id);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"PPA deleted successfully\",\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n};\r\n","import prisma from \"@/lib/prisma\";\r\nimport { ForbiddenError, UnauthorizedError } from \"@/utils/error\";\r\nimport { PPA_STATUS, type Prisma } from \"@prisma/client\";\r\n\r\nconst ppaSelect: Prisma.PPASelect = {\r\n  id: true,\r\n  task: true,\r\n  description: true,\r\n  address: true,\r\n  venue: true,\r\n  expectedOutput: true,\r\n  startDate: true,\r\n  dueDate: true,\r\n  sector: true,\r\n  implementingUnit: true,\r\n  sectorId: true,\r\n  hourBeforeNotifiedAt: true,\r\n  dayBeforeNotifiedAt: true,\r\n  archivedAt: true,\r\n  userId: true,\r\n  status: true,\r\n  remarks: true,\r\n  actualOutput: true,\r\n  delayedReason: true,\r\n  budgetAllocation: true,\r\n  approvedBudget: true,\r\n  attendees: {\r\n    select: {\r\n      id: true,\r\n      name: true,\r\n    },\r\n  },\r\n  user: {\r\n    select: {\r\n      pushToken: true,\r\n    },\r\n  },\r\n} as const;\r\n\r\nexport const ppaRepository = {\r\n  async findById(id: string) {\r\n    return prisma.pPA.findUnique({\r\n      where: { id },\r\n      select: ppaSelect,\r\n    });\r\n  },\r\n\r\n  async findAll() {\r\n    return prisma.pPA.findMany({\r\n      select: ppaSelect,\r\n      orderBy: { startDate: \"asc\" },\r\n      where: {\r\n        archivedAt: null,\r\n      },\r\n    });\r\n  },\r\n\r\n  async findAllArchived() {\r\n    return prisma.pPA.findMany({\r\n      select: ppaSelect,\r\n      orderBy: { startDate: \"asc\" },\r\n      where: {\r\n        archivedAt: {\r\n          not: null,\r\n        },\r\n      },\r\n    });\r\n  },\r\n\r\n  async findAllWithoutDayBeforeNotification() {\r\n    const tomorrow = new Date();\r\n    tomorrow.setDate(tomorrow.getDate() + 1);\r\n    tomorrow.setHours(0, 0, 0, 0);\r\n\r\n    const dayAfterTomorrow = new Date(tomorrow);\r\n    dayAfterTomorrow.setDate(tomorrow.getDate() + 1);\r\n\r\n    return prisma.pPA.findMany({\r\n      where: {\r\n        dayBeforeNotifiedAt: null,\r\n        archivedAt: null,\r\n        startDate: {\r\n          gte: tomorrow,\r\n          lt: dayAfterTomorrow,\r\n        },\r\n      },\r\n      select: ppaSelect,\r\n      orderBy: { startDate: \"asc\" },\r\n    });\r\n  },\r\n\r\n  async findTodayPPAsWithoutHourNotification() {\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n\r\n    const tomorrow = new Date(today);\r\n    tomorrow.setDate(today.getDate() + 1);\r\n\r\n    return prisma.pPA.findMany({\r\n      where: {\r\n        hourBeforeNotifiedAt: null,\r\n        archivedAt: null,\r\n        startDate: {\r\n          gte: today,\r\n          lt: tomorrow,\r\n        },\r\n      },\r\n      select: ppaSelect,\r\n      orderBy: { startDate: \"asc\" },\r\n    });\r\n  },\r\n\r\n  async findBySector(sectorId: string) {\r\n    return prisma.pPA.findMany({\r\n      where: { sectorId },\r\n      select: ppaSelect,\r\n    });\r\n  },\r\n\r\n  async findByImplementingUnit(implementingUnitId: string) {\r\n    return prisma.pPA.findMany({\r\n      where: { implementingUnitId },\r\n      select: ppaSelect,\r\n    });\r\n  },\r\n\r\n  async create(data: {\r\n    task: string;\r\n    description: string;\r\n    address: string;\r\n    venue?: string;\r\n    expectedOutput: string;\r\n    startDate: Date;\r\n    dueDate: Date;\r\n    sectorId: string;\r\n    budgetAllocation?: string;\r\n    approvedBudget?: string;\r\n    implementingUnitId: string;\r\n    userId: string;\r\n    attendees?: string[];\r\n  }) {\r\n    const ppa = await prisma.pPA.create({\r\n      data: {\r\n        task: data.task,\r\n        description: data.description,\r\n        address: data.address,\r\n        venue: data.venue,\r\n        expectedOutput: data.expectedOutput,\r\n        startDate: data.startDate,\r\n        dueDate: data.dueDate,\r\n        sectorId: data.sectorId,\r\n        budgetAllocation: data.budgetAllocation,\r\n        approvedBudget: data.approvedBudget,\r\n        implementingUnitId: data.implementingUnitId,\r\n        userId: data.userId,\r\n        attendees:\r\n          data.attendees && data.attendees.length > 0\r\n            ? {\r\n                connect: data.attendees.map((id) => ({ id })),\r\n              }\r\n            : undefined,\r\n      },\r\n      include: {\r\n        attendees: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n            email: true,\r\n          },\r\n        },\r\n        sector: true,\r\n        implementingUnit: true,\r\n      },\r\n    });\r\n\r\n    return ppa;\r\n  },\r\n\r\n  async update(ppaId: string, data: Prisma.PPAUpdateInput, userId?: string) {\r\n    const ppa = await prisma.pPA.findFirst({\r\n      where: {\r\n        id: ppaId,\r\n        userId,\r\n      },\r\n      select: {\r\n        id: true,\r\n      },\r\n    });\r\n\r\n  \r\n    if (!ppa) {\r\n      throw new ForbiddenError(\r\n        \"You are not authorized to perform this action.\"\r\n      );\r\n    }\r\n\r\n    return prisma.pPA.update({\r\n      where: {\r\n        id: ppaId,\r\n      },\r\n      data,\r\n      select: ppaSelect,\r\n    });\r\n  },\r\n\r\n  async delete(userId: string, ppaId: string) {\r\n    const ppa = await prisma.pPA.findFirst({\r\n      where: {\r\n        id: ppaId,\r\n        userId,\r\n      },\r\n      select: { id: true },\r\n    });\r\n\r\n    if (!ppa) {\r\n      throw new ForbiddenError(\r\n        \"You are not authorized to perform this action.\"\r\n      );\r\n    }\r\n\r\n    return prisma.pPA.update({\r\n      where: { id: ppaId },\r\n      data: { archivedAt: new Date() },\r\n      select: ppaSelect,\r\n    });\r\n  },\r\n\r\n  async findOverlappingPPAs(\r\n    startDate: Date,\r\n    dueDate: Date,\r\n    excludePPAId?: string,\r\n    venue?: string\r\n  ) {\r\n    const start = new Date(startDate);\r\n    const end = new Date(dueDate);\r\n    start.setHours(0, 0, 0, 0);\r\n    end.setHours(23, 59, 59, 999);\r\n\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n\r\n    const whereClause: any = {\r\n      AND: [\r\n        { startDate: { lte: end } },\r\n        { dueDate: { gte: start } },\r\n        { dueDate: { gt: today } },\r\n        {\r\n          venue: venue,\r\n        },\r\n      ],\r\n    };\r\n\r\n    if (excludePPAId) {\r\n      whereClause.id = { not: excludePPAId };\r\n    }\r\n\r\n    return prisma.pPA.findMany({\r\n      where: whereClause,\r\n      include: {\r\n        sector: { select: { id: true, name: true } },\r\n        implementingUnit: { select: { id: true, name: true } },\r\n      },\r\n      orderBy: { startDate: \"asc\" },\r\n    });\r\n  },\r\n};\r\n","import admin from \"firebase-admin\";\r\nimport cron from \"node-cron\";\r\nimport { ppaRepository } from \"@/data/ppa\";\r\nimport { userRepository } from \"@/data/user\";\r\nimport { dateTime } from \"@/utils/dates\";\r\nimport { envConfig } from \"@/config/env\";\r\n\r\nconst serviceAccount = JSON.parse(\r\n  Buffer.from(envConfig.SERVICE_ACCOUNT_JSON!, \"base64\").toString(),\r\n);\r\n\r\nif (!admin.apps.length) {\r\n  try {\r\n    admin.initializeApp({\r\n      credential: admin.credential.cert(serviceAccount as admin.ServiceAccount),\r\n    });\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\nconst sentReminders = new Set<string>();\r\n\r\nfunction detectPlatform(pushToken: string): \"fcm\" | \"apns\" | null {\r\n  if (!pushToken) return null;\r\n  if (/^[0-9a-f]{64}$/i.test(pushToken)) return \"apns\";\r\n  return \"fcm\";\r\n}\r\n\r\nasync function sendFCMNotification({\r\n  fcmToken,\r\n  title,\r\n  body,\r\n  data = {},\r\n}: {\r\n  fcmToken: string;\r\n  title: string;\r\n  body: string;\r\n  data?: Record<string, string>;\r\n}) {\r\n  const message = {\r\n    token: fcmToken,\r\n    notification: { title, body },\r\n    data,\r\n    android: {\r\n      priority: \"high\" as const,\r\n      notification: {\r\n        channelId: \"default\",\r\n        sound: \"default\",\r\n        priority: \"high\" as const,\r\n      },\r\n    },\r\n  };\r\n  try {\r\n    await admin.messaging().send(message);\r\n    return true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function sendAPNsNotification({\r\n  apnsToken,\r\n  title,\r\n  body,\r\n  data = {},\r\n}: {\r\n  apnsToken: string;\r\n  title: string;\r\n  body: string;\r\n  data?: Record<string, string>;\r\n}) {\r\n  const message = {\r\n    token: apnsToken,\r\n    notification: { title, body },\r\n    data,\r\n    apns: {\r\n      payload: {\r\n        aps: { alert: { title, body }, sound: \"default\", badge: 1 },\r\n      },\r\n    },\r\n  };\r\n  try {\r\n    await admin.messaging().send(message);\r\n    return true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function sendPushNotification({\r\n  ppaId,\r\n  pushToken,\r\n  title,\r\n  body,\r\n  notificationType,\r\n}: {\r\n  ppaId: string;\r\n  pushToken: string;\r\n  title: string;\r\n  body: string;\r\n  notificationType: \"day_before\" | \"hour_before\";\r\n}) {\r\n  if (!pushToken) return false;\r\n  const platform = detectPlatform(pushToken);\r\n  if (!platform) return false;\r\n\r\n  const data: Record<string, string> = { ppaId };\r\n  if (notificationType) data.notificationType = notificationType;\r\n\r\n  let success = false;\r\n  try {\r\n    if (platform === \"fcm\") {\r\n      success = await sendFCMNotification({\r\n        fcmToken: pushToken,\r\n        title,\r\n        body,\r\n        data,\r\n      });\r\n    } else {\r\n      success = await sendAPNsNotification({\r\n        apnsToken: pushToken,\r\n        title,\r\n        body,\r\n        data,\r\n      });\r\n    }\r\n    return success;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function checkDayBeforeReminders() {\r\n  const activeUsers = await userRepository.findActiveUsersWithPushTokens();\r\n  if (!activeUsers || activeUsers.length === 0) return;\r\n\r\n  const ppas = await ppaRepository.findAllWithoutDayBeforeNotification();\r\n  if (!ppas || ppas.length === 0) return;\r\n\r\n  const now = dateTime.now();\r\n\r\n  for (const ppa of ppas) {\r\n    if (!ppa.startDate) continue;\r\n    const startDateTime = dateTime.parse(ppa.startDate);\r\n    const tomorrow = now.clone().add(1, \"day\");\r\n    const isTomorrow = startDateTime.isSame(tomorrow, \"day\");\r\n    if (!isTomorrow) continue;\r\n\r\n    let successCount = 0;\r\n    for (const user of activeUsers) {\r\n      if (!user.pushToken) continue;\r\n      const reminderKey = `${ppa.id}-${user.id}-day-before`;\r\n      if (sentReminders.has(reminderKey)) continue;\r\n\r\n      const success = await sendPushNotification({\r\n        ppaId: ppa.id,\r\n        pushToken: user.pushToken,\r\n        title: `ðŸ“… Reminder: ${ppa.task} starts tomorrow!`,\r\n        body: `It begins at ${dateTime.formatTime(ppa.startDate)} and ends on ${dateTime.formatDateShort(ppa.dueDate)} at ${dateTime.formatTime(ppa.dueDate)}. Don't forget to prepare!`,\r\n        notificationType: \"day_before\",\r\n      });\r\n\r\n      if (success) sentReminders.add(reminderKey);\r\n      successCount++;\r\n      await new Promise((r) => setTimeout(r, 100));\r\n    }\r\n    if (successCount > 0)\r\n      await ppaRepository.update(ppa.id, { dayBeforeNotifiedAt: new Date() });\r\n  }\r\n}\r\n\r\nasync function checkHourBeforeReminders() {\r\n  const activeUsers = await userRepository.findActiveUsersWithPushTokens();\r\n  if (!activeUsers || activeUsers.length === 0) return;\r\n\r\n  const ppas = await ppaRepository.findTodayPPAsWithoutHourNotification();\r\n  if (!ppas || ppas.length === 0) return;\r\n\r\n  const now = dateTime.now();\r\n\r\n  for (const ppa of ppas) {\r\n    if (!ppa.startDate) continue;\r\n    const startDateTime = dateTime.parse(ppa.startDate);\r\n    const isToday = startDateTime.isSame(now, \"day\");\r\n    if (!isToday) continue;\r\n\r\n    const minutesUntilStart = startDateTime.diff(now, \"minutes\");\r\n    if (minutesUntilStart < 110 || minutesUntilStart > 130) continue;\r\n\r\n    let successCount = 0;\r\n    for (const user of activeUsers) {\r\n      if (!user.pushToken) continue;\r\n      const reminderKey = `${ppa.id}-${user.id}-hour-before`;\r\n      if (sentReminders.has(reminderKey)) continue;\r\n\r\n      const success = await sendPushNotification({\r\n        ppaId: ppa.id,\r\n        pushToken: user.pushToken,\r\n        title: `â° Starting Soon: ${ppa.task}`,\r\n        body: `Your event starts in about 2 hours at ${dateTime.formatTime(ppa.startDate)}. Location: ${ppa.venue || ppa.address}`,\r\n        notificationType: \"hour_before\",\r\n      });\r\n\r\n      if (success) sentReminders.add(reminderKey);\r\n      successCount++;\r\n      await new Promise((r) => setTimeout(r, 100));\r\n    }\r\n    if (successCount > 0)\r\n      await ppaRepository.update(ppa.id, { hourBeforeNotifiedAt: new Date() });\r\n  }\r\n}\r\n\r\nexport async function remindReschedulePPA({\r\n  ppaId,\r\n  pushToken,\r\n  title,\r\n  body,\r\n}: {\r\n  ppaId: string;\r\n  pushToken: string;\r\n  title: string;\r\n  body: string;\r\n}) {\r\n  if (!pushToken) return false;\r\n  const platform = detectPlatform(pushToken);\r\n  if (!platform) return false;\r\n\r\n  const data = { ppaId };\r\n  let success = false;\r\n  try {\r\n    if (platform === \"fcm\") {\r\n      success = await sendFCMNotification({\r\n        fcmToken: pushToken,\r\n        title,\r\n        body,\r\n        data,\r\n      });\r\n    } else {\r\n      success = await sendAPNsNotification({\r\n        apnsToken: pushToken,\r\n        title,\r\n        body,\r\n        data,\r\n      });\r\n    }\r\n    return success;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function startCronScheduler() {\r\n  cron.schedule(\r\n    \"* * * * *\",\r\n    async () => {\r\n      await checkHourBeforeReminders();\r\n    },\r\n    {\r\n      timezone: \"Asia/Manila\",\r\n    },\r\n  );\r\n\r\n  cron.schedule(\r\n    \"55 15 * * *\",\r\n    async () => {\r\n      await checkDayBeforeReminders();\r\n    },\r\n    {\r\n      timezone: \"Asia/Manila\",\r\n    },\r\n  );\r\n}\r\n","import moment from \"moment-timezone\";\r\n\r\nconst DEFAULT_TIMEZONE = \"Asia/Manila\";\r\n\r\n\r\nclass DateTimeUtil {\r\n  private timezone: string;\r\n\r\n  constructor(timezone: string = DEFAULT_TIMEZONE) {\r\n    this.timezone = timezone;\r\n  }\r\n\r\n  /**\r\n   * Parse a date stored in local Manila time\r\n   */\r\n  parse(date: string | Date | number) {\r\n    return moment.tz(date, this.timezone);\r\n  }\r\n\r\n  /**\r\n   * Format date as \"Month Day, Year\" (e.g., \"December 26, 2025\")\r\n   */\r\n  formatDate(date: string | Date | number): string {\r\n    return this.parse(date).format(\"MMMM D, YYYY\");\r\n  }\r\n\r\n  formatTime(date: string | Date | number): string {\r\n    return this.parse(date).format(\"h:mm A\");\r\n  }\r\n\r\n  /**\r\n   * Format date with time as \"Month Day, Year at HH:MM AM/PM\"\r\n   */\r\n  formatDateTime(date: string | Date | number): string {\r\n    return this.parse(date).format(\"MMMM D, YYYY [at] h:mm A\");\r\n  }\r\n\r\n  /**\r\n   * Format date as short format \"MMM D, YYYY\" (e.g., \"Dec 26, 2025\")\r\n   */\r\n  formatDateShort(date: string | Date | number): string {\r\n    return this.parse(date).format(\"MMM D, YYYY\");\r\n  }\r\n\r\n  /**\r\n   * Get relative time (e.g., \"2 days ago\", \"in 3 hours\")\r\n   */\r\n  fromNow(date: string | Date | number): string {\r\n    return this.parse(date).fromNow();\r\n  }\r\n\r\n  /**\r\n   * Get current date/time in Manila timezone\r\n   */\r\n  now() {\r\n    return moment.tz(this.timezone);\r\n  }\r\n\r\n  /**\r\n   * Custom format with any moment format string\r\n   */\r\n  format(date: string | Date | number, formatString: string): string {\r\n    return this.parse(date).format(formatString);\r\n  }\r\n}\r\n\r\nexport const dateTime = new DateTimeUtil();\r\n\r\nexport default DateTimeUtil;\r\n","import { ppaRepository } from \"@/data/ppa\";\r\n\r\nexport const venueService = {\r\n  async checkLocationAvailability(\r\n    startDate: Date,\r\n    dueDate: Date,\r\n    excludePPAId?: string,\r\n    venue?: string,\r\n  ) {\r\n    const ppas = await ppaRepository.findOverlappingPPAs(\r\n      startDate,\r\n      dueDate,\r\n      excludePPAId,\r\n      venue,\r\n    );\r\n\r\n    const conflictingPPAs = ppas.map((ppa) => ({\r\n      id: ppa.id,\r\n      task: ppa.task,\r\n      description: ppa.description,\r\n      startDate: ppa.startDate,\r\n      dueDate: ppa.dueDate,\r\n      venue: ppa.venue,\r\n      sector: ppa.sector,\r\n      implementingUnit: ppa.implementingUnit,\r\n    }));\r\n\r\n    console.log(\"Conflicting PPAs:\", conflictingPPAs);\r\n\r\n    return {\r\n      available: conflictingPPAs.length === 0,\r\n      conflictingPPAs,\r\n    };\r\n  },\r\n};\r\n","import { ppaRepository } from \"@/data/ppa\";\r\nimport { NotFoundError, BadRequestError, ForbiddenError } from \"@/utils/error\";\r\nimport { remindReschedulePPA } from \"./notificationService\";\r\nimport { venueService } from \"@/services/venue\";\r\nimport { dateTime } from \"@/utils/dates\";\r\n\r\nexport const ppaService = {\r\n  async getPPAById(id: string) {\r\n    const ppa = await ppaRepository.findById(id);\r\n    if (!ppa) throw new NotFoundError(\"PPA not found\");\r\n    return ppa;\r\n  },\r\n\r\n  async getAllPPAs() {\r\n    const ppas = await ppaRepository.findAll();\r\n\r\n    const mappedPPA = ppas.map((ppa) => ({\r\n      ...ppa,\r\n      attendees: ppa.attendees.map((attendee) => ({\r\n        label: attendee.name,\r\n        value: attendee.id,\r\n      })),\r\n    }));\r\n\r\n    return mappedPPA;\r\n  },\r\n\r\n  async getAllArchived() {\r\n    return ppaRepository.findAllArchived();\r\n  },\r\n\r\n  async getPPAsBySector(sectorId: string) {\r\n    return ppaRepository.findBySector(sectorId);\r\n  },\r\n\r\n  async getPPAsByImplementingUnit(implementingUnitId: string) {\r\n    return ppaRepository.findByImplementingUnit(implementingUnitId);\r\n  },\r\n\r\n  async createPPA(data: Parameters<typeof ppaRepository.create>[0]) {\r\n    if (!data.task || !data.sectorId || !data.implementingUnitId) {\r\n      throw new BadRequestError(\"Missing required fields\");\r\n    }\r\n\r\n    const availability = await venueService.checkLocationAvailability(\r\n      data.startDate,\r\n      data.dueDate,\r\n      undefined,\r\n      data.venue\r\n    );\r\n    if (!availability.available) {\r\n      throw new ForbiddenError(\r\n        `Venue is not available: ${data.venue} is already occupied for the selected dates.`\r\n      );\r\n    }\r\n\r\n    return ppaRepository.create(data);\r\n  },\r\n\r\n  async updatePPA(ppaId: string, data: any, userId: string) {\r\n    const existing = await this.getPPAById(ppaId);\r\n\r\n    const availability = await venueService.checkLocationAvailability(\r\n      data.startDate,\r\n      data.dueDate,\r\n      ppaId,\r\n      data.venue\r\n    );\r\n    if (!availability.available) {\r\n      throw new ForbiddenError(\r\n        `Venue is not available: ${data.venue} is already occupied for the selected dates.`\r\n      );\r\n    }\r\n\r\n    const updatedPPA = await ppaRepository.update(ppaId, data, userId);\r\n\r\n    const existingStartDate = dateTime.parse(existing.startDate);\r\n    const newStartDate = data.startDate ? dateTime.parse(data.startDate) : null;\r\n    const existingDueDate = dateTime.parse(existing.dueDate);\r\n    const newDueDate = data.dueDate ? dateTime.parse(data.dueDate) : null;\r\n\r\n    const startDateChanged = \r\n      newStartDate && !existingStartDate.isSame(newStartDate);\r\n    const dueDateChanged = \r\n      newDueDate && !existingDueDate.isSame(newDueDate);\r\n\r\n    if (startDateChanged || dueDateChanged) {\r\n      let scheduleMessage = \"The PPA has been rescheduled.\";\r\n      \r\n      if (startDateChanged && dueDateChanged) {\r\n        scheduleMessage = `New schedule: ${dateTime.formatDateTime(data.startDate)} to ${dateTime.formatDateTime(data.dueDate)}`;\r\n      } else if (startDateChanged) {\r\n        scheduleMessage = `New start time: ${dateTime.formatDateTime(data.startDate)}`;\r\n      } else if (dueDateChanged) {\r\n        scheduleMessage = `New end time: ${dateTime.formatDateTime(data.dueDate)}`;\r\n      }\r\n\r\n      const title = \"ðŸ“… PPA Rescheduled\";\r\n      const body = `Reminder: \"${updatedPPA.task}\" has been rescheduled. ${scheduleMessage}`;\r\n      \r\n      await remindReschedulePPA({\r\n        ppaId,\r\n        pushToken: updatedPPA?.user?.pushToken as string,\r\n        title,\r\n        body,\r\n      });\r\n      \r\n      console.log(`âœ… Reschedule notification sent for PPA: ${updatedPPA.task}`);\r\n    }\r\n\r\n    return updatedPPA;\r\n  },\r\n\r\n  async deletePPA(userId: string, ppaId: string) {\r\n    await this.getPPAById(ppaId);\r\n\r\n    return ppaRepository.delete(userId, ppaId);\r\n  },\r\n};","import { Hono } from \"hono\";\r\nimport { authMiddleware, requireRole } from \"@/middlewares/auth\";\r\nimport { sectorHandler } from \"@/controllers/sector\";\r\nconst router = new Hono();\r\n\r\nrouter.get(\"/sectors\", authMiddleware, sectorHandler.getAll);\r\nrouter.post(\"/sectors\", authMiddleware, sectorHandler.create);\r\nrouter.patch(\"/sectors/:id\", authMiddleware, sectorHandler.update);\r\nrouter.delete(\"/sectors/:id\", authMiddleware, sectorHandler.delete);\r\n\r\nexport default router;\r\n","import type { Context } from \"hono\";\r\nimport { StatusCodes } from \"http-status-codes\";\r\nimport { BadRequestError } from \"@/utils/error\";\r\nimport { sectorService } from \"@/services/sector\";\r\n\r\nexport const sectorHandler = {\r\n  async getAll(c: Context) {\r\n    const sectors = await sectorService.getAllSectors();\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { sectors },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getById(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const sector = await sectorService.getSectorById(id);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { sector },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async create(c: Context) {\r\n    const { name, description } = await c.req.json();\r\n\r\n    const sector = await sectorService.createSector(name, description);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Sector created successfully\",\r\n        data: { sector },\r\n      },\r\n      StatusCodes.CREATED\r\n    );\r\n  },\r\n\r\n  async update(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const { name, description } = await c.req.json();\r\n\r\n    const sector = await sectorService.updateSector(id, name, description);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Sector updated successfully\",\r\n        data: { sector },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async delete(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    await sectorService.deleteSector(id);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Sector deleted successfully\",\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n\r\n  async getStats(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const stats = await sectorService.getSectorStats(id);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { stats },\r\n      },\r\n      StatusCodes.OK\r\n    );\r\n  },\r\n};\r\n","import prisma from \"@/lib/prisma\";\r\nimport type { Prisma } from \"@prisma/client\";\r\n\r\nconst implementingUnitSelect: Prisma.ImplementingUnitSelect = {\r\n  id: true,\r\n  name: true,\r\n  userId: true,\r\n  deptHead: {\r\n    select: {\r\n      id: true,\r\n      name: true,\r\n      email: true,\r\n      role: true,\r\n    },\r\n  },\r\n\r\n  _count: {\r\n    select: {\r\n      PPA: true,\r\n    },\r\n  },\r\n  PPA: {\r\n    select: {\r\n      id: true,\r\n      task: true,\r\n      description: true,\r\n      address: true,\r\n      startDate: true,\r\n      dueDate: true,\r\n    },\r\n  },\r\n} as const;\r\n\r\nexport const implementingUnitRepository = {\r\n  async findAll() {\r\n    return prisma.implementingUnit.findMany({\r\n      select: implementingUnitSelect,\r\n      orderBy: { name: \"asc\" },\r\n    });\r\n  },\r\n\r\n  async findById(id: string) {\r\n    return prisma.implementingUnit.findUnique({\r\n      where: { id },\r\n      select: implementingUnitSelect,\r\n    });\r\n  },\r\n\r\n \r\n\r\n  async findByUserId(userId: string) {\r\n    return prisma.implementingUnit.findUnique({\r\n      where: { userId },\r\n      select: implementingUnitSelect,\r\n    });\r\n  },\r\n\r\n  async findByName(name: string) {\r\n    return prisma.implementingUnit.findFirst({\r\n      where: { name },\r\n    });\r\n  },\r\n\r\n  async create(name: string, userId: string) {\r\n    return prisma.implementingUnit.create({\r\n      data: { name, userId },\r\n      select: implementingUnitSelect,\r\n    });\r\n  },\r\n\r\n  async update(id: string, name: string, userId: string) {\r\n    return prisma.implementingUnit.update({\r\n      where: { id },\r\n      data: { name, userId },\r\n      select: implementingUnitSelect,\r\n    });\r\n  },\r\n\r\n  async delete(id: string) {\r\n    return prisma.implementingUnit.delete({\r\n      where: { id },\r\n    });\r\n  },\r\n\r\n  async updateDepartmentHead(id: string, userId: string) {\r\n    return prisma.implementingUnit.update({\r\n      where: { id },\r\n      data: { userId },\r\n      select: implementingUnitSelect,\r\n    });\r\n  },\r\n};\r\n","import prisma from \"@/lib/prisma\";\r\n\r\nconst sectorSelect = {\r\n  id: true,\r\n  name: true,\r\n  description: true,\r\n  _count: {\r\n    select: {\r\n      PPA: true,\r\n    },\r\n  },\r\n} as const;\r\n\r\nexport const sectorRepository = {\r\n  async findAll() {\r\n    return prisma.sector.findMany({\r\n      select: sectorSelect,\r\n      orderBy: { name: \"asc\" },\r\n    });\r\n  },\r\n\r\n  async findById(id: string) {\r\n    return prisma.sector.findUnique({\r\n      where: { id },\r\n      select: {\r\n        ...sectorSelect,\r\n        PPA: {\r\n          select: {\r\n            id: true,\r\n            task: true,\r\n            description: true,\r\n            startDate: true,\r\n            dueDate: true,\r\n          },\r\n        },\r\n      },\r\n    });\r\n  },\r\n\r\n  async findByName(name: string) {\r\n    return prisma.sector.findFirst({\r\n      where: { name },\r\n    });\r\n  },\r\n\r\n  async create(name: string, description: string) {\r\n    return prisma.sector.create({\r\n      data: { name, description },\r\n      select: sectorSelect,\r\n    });\r\n  },\r\n\r\n  async update(id: string, name: string, description: string) {\r\n    return prisma.sector.update({\r\n      where: { id },\r\n      data: { name, description },\r\n      select: sectorSelect,\r\n    });\r\n  },\r\n\r\n  async delete(id: string) {\r\n    return prisma.sector.delete({\r\n      where: { id },\r\n    });\r\n  },\r\n\r\n  async getSectorWithStats(id: string) {\r\n    return prisma.sector.findUnique({\r\n      where: { id },\r\n      select: {\r\n        id: true,\r\n        name: true,\r\n        description: true,\r\n        _count: {\r\n          select: {\r\n            PPA: true,\r\n          },\r\n        },\r\n      },\r\n    });\r\n  },\r\n};\r\n","import { implementingUnitRepository } from \"@/data/implementingUnit\";\r\nimport { sectorRepository } from \"@/data/sector\";\r\nimport { NotFoundError, BadRequestError, ConflictError } from \"@/utils/error\";\r\n\r\nexport const sectorService = {\r\n  async getAllSectors() {\r\n    return sectorRepository.findAll();\r\n  },\r\n\r\n  async getSectorById(id: string) {\r\n    const sector = await sectorRepository.findById(id);\r\n    if (!sector) {\r\n      throw new NotFoundError(\"Sector not found\");\r\n    }\r\n    return sector;\r\n  },\r\n\r\n  async createSector(name: string, description: string) {\r\n    const existingSector = await sectorRepository.findByName(name);\r\n    if (existingSector) {\r\n      throw new ConflictError(\"Sector with this name already exists\");\r\n    }\r\n\r\n    return sectorRepository.create(name, description);\r\n  },\r\n\r\n  async updateSector(id: string, name: string, description: string) {\r\n    const sector = await sectorRepository.findById(id);\r\n    if (!sector) {\r\n      throw new NotFoundError(\"Sector not found\");\r\n    }\r\n\r\n    const existingSector = await sectorRepository.findByName(name);\r\n    if (existingSector && existingSector.id !== id) {\r\n      throw new ConflictError(\"Sector with this name already exists\");\r\n    }\r\n\r\n    return sectorRepository.update(id, name, description);\r\n  },\r\n\r\n  async deleteSector(id: string) {\r\n    const sector = await sectorRepository.findById(id);\r\n    if (!sector) {\r\n      throw new NotFoundError(\"Sector not found\");\r\n    }\r\n\r\n    return sectorRepository.delete(id);\r\n  },\r\n\r\n  async getSectorStats(id: string) {\r\n    const sector = await sectorRepository.getSectorWithStats(id);\r\n    if (!sector) {\r\n      throw new NotFoundError(\"Sector not found\");\r\n    }\r\n    return sector;\r\n  },\r\n};\r\n","import { Hono } from \"hono\";\r\nimport { authMiddleware, requireRole } from \"@/middlewares/auth\";\r\nimport { implementingUnitHandler } from \"@/controllers/implementingUnit\";\r\nconst router = new Hono();\r\n\r\nrouter.post(\r\n  \"/implementing-units\",\r\n  authMiddleware,\r\n  implementingUnitHandler.create,\r\n);\r\nrouter.get(\r\n  \"/implementing-units\",\r\n  authMiddleware,\r\n  implementingUnitHandler.getAll,\r\n);\r\nrouter.delete(\r\n  \"/implementing-units/:id\",\r\n  authMiddleware,\r\n  implementingUnitHandler.delete,\r\n);\r\nrouter.patch(\r\n  \"/implementing-units/:id\",\r\n  authMiddleware,\r\n  implementingUnitHandler.update,\r\n);\r\n// router.get(\r\n//   \"/implementing-units/sector/:sectorId\",\r\n//   authMiddleware,\r\n//   implementingUnitHandler.getBySectorId,\r\n// );\r\n\r\nexport default router;\r\n","import type { Context } from \"hono\";\r\nimport { StatusCodes } from \"http-status-codes\";\r\nimport { BadRequestError } from \"@/utils/error\";\r\nimport { implementingUnitService } from \"@/services/implementingUnit\";\r\n\r\nexport const implementingUnitHandler = {\r\n  async getAll(c: Context) {\r\n    const units = await implementingUnitService.getAllImplementingUnits();\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { implementingUnits: units },\r\n      },\r\n      StatusCodes.OK,\r\n    );\r\n  },\r\n\r\n  async getById(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const unit = await implementingUnitService.getImplementingUnitById(id);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { implementingUnit: unit },\r\n      },\r\n      StatusCodes.OK,\r\n    );\r\n  },\r\n\r\n \r\n  async getByUserId(c: Context) {\r\n    const userId = c.req.param(\"userId\");\r\n    const unit =\r\n      await implementingUnitService.getImplementingUnitByUserId(userId);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        data: { implementingUnit: unit },\r\n      },\r\n      StatusCodes.OK,\r\n    );\r\n  },\r\n\r\n  async create(c: Context) {\r\n    const { name, userId } = await c.req.json();\r\n\r\n    if (!name || !userId) {\r\n      throw new BadRequestError(\"Name, userId are required\");\r\n    }\r\n\r\n    const unit = await implementingUnitService.createImplementingUnit(\r\n      name,\r\n      userId,\r\n    );\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Implementing unit created successfully\",\r\n        data: { implementingUnit: unit },\r\n      },\r\n      StatusCodes.CREATED,\r\n    );\r\n  },\r\n\r\n  async update(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const { name, userId } = await c.req.json();\r\n\r\n    if (!name || !userId) {\r\n      throw new BadRequestError(\"Name, userId are required\");\r\n    }\r\n\r\n    const unit = await implementingUnitService.updateImplementingUnit(\r\n      id,\r\n      name,\r\n      userId,\r\n    );\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Implementing unit updated successfully\",\r\n        data: { implementingUnit: unit },\r\n      },\r\n      StatusCodes.OK,\r\n    );\r\n  },\r\n\r\n  async delete(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    await implementingUnitService.deleteImplementingUnit(id);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Implementing unit deleted successfully\",\r\n      },\r\n      StatusCodes.OK,\r\n    );\r\n  },\r\n\r\n  async changeDepartmentHead(c: Context) {\r\n    const id = c.req.param(\"id\");\r\n    const { userId } = await c.req.json();\r\n\r\n    if (!userId) {\r\n      throw new BadRequestError(\"userId is required\");\r\n    }\r\n\r\n    const unit = await implementingUnitService.changeDepartmentHead(id, userId);\r\n\r\n    return c.json(\r\n      {\r\n        success: true,\r\n        message: \"Department head changed successfully\",\r\n        data: { implementingUnit: unit },\r\n      },\r\n      StatusCodes.OK,\r\n    );\r\n  },\r\n};\r\n","import { implementingUnitRepository } from \"@/data/implementingUnit\";\r\nimport { userRepository } from \"@/data/user\";\r\nimport { NotFoundError, BadRequestError, ConflictError } from \"@/utils/error\";\r\n\r\nexport const implementingUnitService = {\r\n  async getAllImplementingUnits() {\r\n    return implementingUnitRepository.findAll();\r\n  },\r\n\r\n  async getImplementingUnitById(id: string) {\r\n    const unit = await implementingUnitRepository.findById(id);\r\n    if (!unit) {\r\n      throw new NotFoundError(\"Implementing unit not found\");\r\n    }\r\n    return unit;\r\n  },\r\n\r\n\r\n\r\n  async getImplementingUnitByUserId(userId: string) {\r\n    const unit = await implementingUnitRepository.findByUserId(userId);\r\n    if (!unit) {\r\n      throw new NotFoundError(\"No implementing unit assigned to this user\");\r\n    }\r\n    return unit;\r\n  },\r\n\r\n  async createImplementingUnit(name: string, userId: string) {\r\n    if (!name || !userId) {\r\n      throw new BadRequestError(\"Name, userId are required\");\r\n    }\r\n\r\n    const existingUnit = await implementingUnitRepository.findByName(name);\r\n    if (existingUnit) {\r\n      throw new ConflictError(\r\n        \"Implementing unit with this name already exists\"\r\n      );\r\n    }\r\n\r\n    const user = await userRepository.findById(userId);\r\n    if (!user) {\r\n      throw new NotFoundError(\"User not found\");\r\n    }\r\n\r\n    const existingDeptHead =\r\n      await implementingUnitRepository.findByUserId(userId);\r\n    if (existingDeptHead) {\r\n      throw new ConflictError(\"User is already assigned as a department head\");\r\n    }\r\n\r\n    await userRepository.updateDepartmentHeadStatus(userId, true);\r\n\r\n    return implementingUnitRepository.create(name, userId);\r\n  },\r\n\r\n  async updateImplementingUnit(\r\n    id: string,\r\n    name: string,\r\n    userId: string\r\n  ) {\r\n    if (!name || !userId) {\r\n      throw new BadRequestError(\"Name, userId are required\");\r\n    }\r\n\r\n    const unit = await implementingUnitRepository.findById(id);\r\n    if (!unit) {\r\n      throw new NotFoundError(\"Implementing unit not found\");\r\n    }\r\n\r\n    const existingUnit = await implementingUnitRepository.findByName(name);\r\n    if (existingUnit && existingUnit.id !== id) {\r\n      throw new ConflictError(\r\n        \"Implementing unit with this name already exists\"\r\n      );\r\n    }\r\n\r\n    const user = await userRepository.findById(userId);\r\n    if (!user) {\r\n      throw new NotFoundError(\"User not found\");\r\n    }\r\n\r\n\r\n    if (unit.userId !== userId) {\r\n      const existingDeptHead =\r\n        await implementingUnitRepository.findByUserId(userId);\r\n      if (existingDeptHead && existingDeptHead.id !== id) {\r\n        throw new ConflictError(\r\n          \"User is already assigned as a department head\"\r\n        );\r\n      }\r\n\r\n      await userRepository.updateDepartmentHeadStatus(unit.userId, false);\r\n\r\n      await userRepository.updateDepartmentHeadStatus(userId, true);\r\n    }\r\n\r\n\r\n    return implementingUnitRepository.update(id, name, userId);\r\n  },\r\n\r\n  async deleteImplementingUnit(id: string) {\r\n    const unit = await implementingUnitRepository.findById(id);\r\n    if (!unit) {\r\n      throw new NotFoundError(\"Implementing unit not found\");\r\n    }\r\n\r\n    if (unit._count.PPA > 0) {\r\n      throw new BadRequestError(\r\n        \"Cannot delete implementing unit with existing PPAs\"\r\n      );\r\n    }\r\n\r\n    await userRepository.updateDepartmentHeadStatus(unit.userId, false);\r\n\r\n    return implementingUnitRepository.delete(id);\r\n  },\r\n\r\n  async changeDepartmentHead(id: string, newUserId: string) {\r\n    const unit = await implementingUnitRepository.findById(id);\r\n    if (!unit) {\r\n      throw new NotFoundError(\"Implementing unit not found\");\r\n    }\r\n\r\n    const newUser = await userRepository.findById(newUserId);\r\n    if (!newUser) {\r\n      throw new NotFoundError(\"User not found\");\r\n    }\r\n\r\n    const existingDeptHead =\r\n      await implementingUnitRepository.findByUserId(newUserId);\r\n    if (existingDeptHead && existingDeptHead.id !== id) {\r\n      throw new ConflictError(\"User is already assigned as a department head\");\r\n    }\r\n\r\n    await userRepository.updateDepartmentHeadStatus(unit.userId, false);\r\n\r\n    await userRepository.updateDepartmentHeadStatus(newUserId, true);\r\n\r\n    return implementingUnitRepository.updateDepartmentHead(id, newUserId);\r\n  },\r\n};\r\n","import usersRoutes from \"./users/routes\";\r\nimport authRoutes from \"./auth/routes\";\r\nimport ppaRoutes from \"./ppa/routes\";\r\nimport sectorRoutes from \"./sector/routes\";\r\nimport implementingUnitRoutes from \"./implementingUnit/routes\";\r\n\r\nexport const routes = [\r\n  usersRoutes,\r\n  authRoutes,\r\n  ppaRoutes,\r\n  sectorRoutes,\r\n  implementingUnitRoutes,\r\n] as const;\r\n\r\nexport type AppRoutes = (typeof routes)[number];\r\n","import { makeError } from \"@/utils/error\";\r\nimport { type Context } from \"hono\";\r\n\r\nexport async function errorHandlerMiddleware(err: Error, c: Context) {\r\n  const { error, statusCode } = makeError(err);\r\n  console.error(statusCode, error);\r\n  return c.json(error, {\r\n    status: statusCode,\r\n  } as any);\r\n}\r\n"],"mappings":"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","names":["import_hono","import_client","import_client","import_client","bcrypt","existingUser","import_http_status_codes","import_hono","import_cookie","import_http_status_codes","router","routes_default","import_hono","import_http_status_codes","import_client","moment","admin","cron","router","routes_default","import_hono","import_http_status_codes","router","routes_default","import_hono","import_http_status_codes","router","routes_default","routes_default","import_hono"]}